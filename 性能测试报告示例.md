# PostgreSQL vs MySQL (Percona Server) 性能对比报告（示例）

**测试日期**: 2025年01月15日 10:30:00

## 测试环境

- **操作系统**: Ubuntu 22.04 LTS (GitHub Actions)
- **CPU**: GitHub Actions Runner (2 核)
- **内存**: 7 GB
- **PostgreSQL 版本**: PostgreSQL 14.x
- **MySQL 版本**: Percona Server 8.0.x

## 测试配置

- **测试工具**: Sysbench
- **表数量**: 10 张
- **表大小**: 100,000 行
- **测试时长**: 60 秒
- **并发线程**: 4, 8, 16

## OLTP 读写混合测试

### 性能指标对比

| 线程数 | 数据库 | TPS | QPS | 平均延迟 (ms) | 95%延迟 (ms) | 总事务数 |
|:------:|:------:|:----:|:----:|:-------------:|:------------:|:--------:|
| 4 | PostgreSQL | 1250.50 | 17507.00 | 3.20 | 4.10 | 75030 |
| 4 | MySQL | 1180.30 | 16524.20 | 3.39 | 4.33 | 70818 |
| 8 | PostgreSQL | 2180.40 | 30525.60 | 3.67 | 4.82 | 130824 |
| 8 | MySQL | 2050.20 | 28702.80 | 3.90 | 5.18 | 123012 |
| 16 | PostgreSQL | 3520.80 | 49291.20 | 4.54 | 6.21 | 211248 |
| 16 | MySQL | 3380.50 | 47327.00 | 4.73 | 6.55 | 202830 |

### 性能对比分析

**4 线程下的对比**:

- **TPS**: PostgreSQL 比 MySQL 高 5.95%
- **QPS**: PostgreSQL 比 MySQL 高 5.95%
- **平均延迟**: PostgreSQL 比 MySQL 低 5.60%

**8 线程下的对比**:

- **TPS**: PostgreSQL 比 MySQL 高 6.35%
- **QPS**: PostgreSQL 比 MySQL 高 6.35%
- **平均延迟**: PostgreSQL 比 MySQL 低 5.90%

**16 线程下的对比**:

- **TPS**: PostgreSQL 比 MySQL 高 4.15%
- **QPS**: PostgreSQL 比 MySQL 高 4.15%
- **平均延迟**: PostgreSQL 比 MySQL 低 4.02%

## OLTP 只读测试

### 性能指标对比

| 线程数 | 数据库 | TPS | QPS | 平均延迟 (ms) | 95%延迟 (ms) | 总事务数 |
|:------:|:------:|:----:|:----:|:-------------:|:------------:|:--------:|
| 4 | PostgreSQL | 3250.70 | 51811.20 | 1.23 | 1.55 | 195042 |
| 4 | MySQL | 3180.40 | 50886.40 | 1.26 | 1.61 | 190824 |
| 8 | PostgreSQL | 5820.30 | 93124.80 | 1.37 | 1.82 | 349218 |
| 8 | MySQL | 5650.20 | 90403.20 | 1.42 | 1.93 | 339012 |
| 16 | PostgreSQL | 9350.50 | 149608.00 | 1.71 | 2.35 | 561030 |
| 16 | MySQL | 9120.80 | 145932.80 | 1.75 | 2.48 | 547248 |

### 性能对比分析

**4 线程下的对比**:

- **TPS**: PostgreSQL 比 MySQL 高 2.21%
- **QPS**: PostgreSQL 比 MySQL 高 1.82%
- **平均延迟**: PostgreSQL 比 MySQL 低 2.38%

**8 线程下的对比**:

- **TPS**: PostgreSQL 比 MySQL 高 3.01%
- **QPS**: PostgreSQL 比 MySQL 高 3.01%
- **平均延迟**: PostgreSQL 比 MySQL 低 3.52%

**16 线程下的对比**:

- **TPS**: PostgreSQL 比 MySQL 高 2.52%
- **QPS**: PostgreSQL 比 MySQL 高 2.52%
- **平均延迟**: PostgreSQL 比 MySQL 低 2.29%

## OLTP 只写测试

### 性能指标对比

| 线程数 | 数据库 | TPS | QPS | 平均延迟 (ms) | 95%延迟 (ms) | 总事务数 |
|:------:|:------:|:----:|:----:|:-------------:|:------------:|:--------:|
| 4 | PostgreSQL | 950.40 | 5702.40 | 4.21 | 5.47 | 57024 |
| 4 | MySQL | 1020.60 | 6123.60 | 3.92 | 5.09 | 61236 |
| 8 | PostgreSQL | 1650.30 | 9901.80 | 4.85 | 6.32 | 99018 |
| 8 | MySQL | 1780.50 | 10683.00 | 4.49 | 5.88 | 106830 |
| 16 | PostgreSQL | 2720.80 | 16324.80 | 5.88 | 7.82 | 163248 |
| 16 | MySQL | 2950.40 | 17702.40 | 5.42 | 7.21 | 177024 |

### 性能对比分析

**4 线程下的对比**:

- **TPS**: MySQL 比 PostgreSQL 高 7.38%
- **QPS**: MySQL 比 PostgreSQL 高 7.38%
- **平均延迟**: MySQL 比 PostgreSQL 低 6.89%

**8 线程下的对比**:

- **TPS**: MySQL 比 PostgreSQL 高 7.89%
- **QPS**: MySQL 比 PostgreSQL 高 7.89%
- **平均延迟**: MySQL 比 PostgreSQL 低 7.42%

**16 线程下的对比**:

- **TPS**: MySQL 比 PostgreSQL 高 8.44%
- **QPS**: MySQL 比 PostgreSQL 高 8.44%
- **平均延迟**: MySQL 比 PostgreSQL 低 7.82%

## 总体性能总结

### PostgreSQL 优势场景

- 复杂查询和分析型工作负载
- 需要强 ACID 保证的场景
- 支持丰富的数据类型和扩展
- 地理空间数据处理 (PostGIS)
- **在读操作和读写混合场景下表现更优**

### MySQL (Percona) 优势场景

- 简单的读写密集型 Web 应用
- 需要主从复制的高可用架构
- 与 PHP/WordPress 等生态系统集成
- 较低的资源占用
- **在纯写入场景下表现更优**

## 测试结论

根据本次测试结果：

1. **OLTP 读写混合场景**: PostgreSQL 在所有并发线程数下均优于 MySQL，平均性能提升约 **5-6%**
2. **OLTP 只读场景**: PostgreSQL 在读取性能上略优于 MySQL，平均性能提升约 **2-3%**
3. **OLTP 只写场景**: MySQL 在写入性能上优于 PostgreSQL，平均性能提升约 **7-8%**

## 建议

根据实际测试结果，建议:

1. **如果追求吞吐量 (TPS/QPS)**，选择在该指标下表现更好的数据库
   - 读多写少的场景：选择 PostgreSQL
   - 写多读少的场景：选择 MySQL

2. **如果追求低延迟**，选择平均延迟和 95% 延迟更低的数据库
   - 读操作：PostgreSQL 延迟更低
   - 写操作：MySQL 延迟更低

3. **考虑实际业务场景**
   - Web 应用通常是读写混合或读多写少，PostgreSQL 可能更合适
   - 日志系统或监控系统（写入密集），MySQL 可能更合适

4. **评估资源消耗**
   - 在生产环境中还需考虑内存、磁盘 I/O、CPU 利用率等因素
   - 建议在接近生产环境的配置下进行完整的性能测试

5. **功能需求考量**
   - PostgreSQL: 更强大的 SQL 功能、JSON 支持、扩展性
   - MySQL: 更成熟的主从复制、更广泛的生态系统支持

---

*报告生成时间: 2025-01-15 10:30:00*

---

**注意**: 这是一个示例报告。实际的性能数据会根据测试环境、硬件配置、数据库版本等因素有所不同。建议在与生产环境相似的配置下进行测试以获得更准确的结果。
